<!doctype html><html lang=en class=dark><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="A look into how I was able to get dozens of free Cadbury chocolates during a flawed promotion"><title>Blakerspace
- Going infinite on Boost bars
</title><link rel=icon href=/favicon.ico><script async src="https://www.googletagmanager.com/gtag/js?id=G-9L3YYLV3KH"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-9L3YYLV3KH")}</script><link rel=stylesheet href="https://blakerspace.net/css/main.min.a6d1d7cbec13fc9904c7492d563d7361.css" crossorigin=anonymous media=screen integrity="md5-ptHXy+wT/JkEx0ktVj1zYQ=="><link rel=stylesheet href=https://blakerspace.net/css/syntax.min.a381883ed9f1079c185da5f1200cd5a9.css crossorigin=anonymous integrity="md5-o4GIPtnxB5wYXaXxIAzVqQ==" media=screen><link rel=stylesheet href="https://blakerspace.net/style/style.min.a4892d0f3d6f0dfd04dc7ec17c39dbb5.css" crossorigin=anonymous media=screen integrity="md5-pIktDz1vDf0E3H7BfDnbtQ=="></head><body class="min-h-screen bg-secondary-light dark:bg-secondary text-primary relative pb-24"><div id=top class=dark></div><header class="w-full flex items-center justify-between px-5 mx-auto md:pt-8 md:max-w-5xl pt-5"><div class="flex items-center"><a href=https://blakerspace.net/ class="inline-block mx-1 font-bold no-underline select-none"><h1 class="hidden md:block font-charter tracking-normal m-0">Blakerspace</h1><div class=md:hidden><div class="w-8 h-8 relative font-bold bg-white blend-diff"><h1 class="absolute-center m-0 font-charter text-2xl text-gray-100 blend-diff select-none">B</h1></div></div></a></div><nav><a href=/ class='mx-1 md:mx-2 hover:text-primary-light dark:hover:text-primary-dark no-underline'>Home
</a><a href=/blog/ class='mx-1 md:mx-2 hover:text-primary-light dark:hover:text-primary-dark no-underline'>Blog</a></nav></header><main class="w-full px-4 pt-8 mx-auto md:max-w-4xl overflow-x-hidden md:overflow-visible"><button onclick=window.history.back() class="bg-transparent border-none font-bold">&larr;Back</button><h1 class="blog-title text-center mx-auto max-w-vw-5/6 text-4xl sm:text-5xl md:text-6xl">Going infinite on Boost bars</h1><div class="blog-content text-justify leading-loose mb-12 mx-auto sm:max-w-vw-5/6 text-md"><h2 id=a-sweet-treat>A sweet treat</h2><p>If you know me, you know I love a sweet treat after a main meal. I had just finished my lunch at work and that all too familiar need for a sweet treat visited. I head down to the nearby Woolworths Metro, and hunt through its labyrinthine aisles hunting for the right treat.</p><p>The choccies caught my eye. Cadbury were running a promotion where buying any specially marked bar gave you the chance to win a second free bar. Fond memories from my childhood of a similar Mars bar promotion filled my heart, and since Boost bars were less than half price, the deal was sealed and my sweet treat hunt concluded with a satisfying $0.90 AUD purchase.</p><p><img class="mx-auto my-4" src=/img/boost-bars/boost-bar.png alt="Boost bars in Australia are caramel and nougat filled choccies with some crunchy bits inside."><div class="text-center my-2 font-sans text-md text-grey-800">Boost bars in Australia are caramel and nougat filled choccies with some crunchy bits inside.</div></p><h2 id=hot-dog-we-have-a-winner>Hot dog, we have a winner</h2><p>Unfortunately, the free bar competition of 2023 was quite different to what I remember from 2003. What I remember is opening the Mars bar and on the inside of the wrapper it told you if you were a winner or not. Then you&rsquo;d bring the wrapper to the school canteen, cautiously pathing away from the bully groups, and get the wrapper exchanged for another bar.</p><p>In 2023, you scanned a QR code, filled in a form with your entire personal information (including mandatory phone number), include &ldquo;proof of purchase&rdquo; (more on this later) and then got told if you win or not. I almost gave up there but like any good Aussie I can&rsquo;t resist a punt so decided to go for it.</p><p>And I won!</p><p><img class="mx-auto my-4" src=/img/boost-bars/cadburyWinner.jpg alt title="Congratulations you are a winner"></p><p>…But that wasn&rsquo;t the end. To get my free bar, I now had to download an app? The &ldquo;Vault Payments app&rdquo;?? I have to give another company my phone number!? I swear Cadbury wouldn&rsquo;t be giving away a single bar because of all these hoops you need to jump through to even win. But me? I was too deep now.</p><p>Cadbury had texted a code to my phone to enter into the Vault Payments app. For the first time in my life I&rsquo;m reminscing about my school days, just take me back to the simplicity of the canteen. Because at this point I&rsquo;m wondering how the heck is this app going to get me a bar.</p><p>In the end, Vault Payments gave me a <em>digital prepaid Visa card</em>, for the recommended retail price of the bar, in this case, $3.</p><p>So I didn&rsquo;t get a free bar, but by buying the bar on sale, I essentially spent 90¢ to get $3. $3 which I could use to buy three more Boost bars, which I could use to win more free bars…</p><p>I could go infinite on Boost bars!</p><h2 id=not-so-fast>Not so fast</h2><p>By &ldquo;going infinite&rdquo; I mean <em>get a lot of Boost bars for free</em>. It was never going to be infinite as the competition terms were clear that there were a fixed amount of winners per day.</p><p>If I even wanted to go a <em>little</em> infinite on chocolate bars, a few major hurdles stood in the way:</p><ul><li><em>One win per phone number per day:</em> After reading the terms and conditions carefully (potentially a world first), I noticed you could only win once per day. Through some trial and error, I did indeed find that I would never win multiple times per day, but my first entry of the day won over 50% of the time; and that it was unique per phone number, not email or name.</li><li><em>It&rsquo;s time consuming:</em> Filling out the entry form, getting the text message, putting the code from the text message into the Vault app, and redeeming the card, took minutes. If I wanted to do more than a handful per day, I would need to automate this for my mental health.</li><li><em>The ethics:</em> Is it wrong for me to try and scale this out and take Cadbury for all they&rsquo;ve got? Then I checked and saw Mondelez (owners of Cadbury) had
<a href="https://ir.mondelezinternational.com/news-releases/news-release-details/mondelez-international-reports-q4-and-fy-2022-results#:~:text=FY%202022-,Gross%20Profit,11%2C312,-0.5" class=underline target=_blank rel=noopener>grossed over 11 billion dollars profit in 2022
</a>and figured they would be okay.</li></ul><h2 id=one-win-per-day>&ldquo;One&rdquo; win per day</h2><p>The one win per day was a real vibe killer for going infinite. I had heard of
<a href=https://www.twilio.com/ class=underline target=_blank rel=noopener>Twilio
</a>, a service which lets you rent phone numbers. These are &ldquo;digital&rdquo; phone numbers — you don&rsquo;t need to get a SIM card or a physical phone or anything — instead, you can configure Twilio to send a message to a server you own on the internet, which you can then process.</p><p><img class="mx-auto my-4" src=/img/boost-bars/twilio.png alt="Twilio UI"><div class="text-center my-2 font-sans text-md text-grey-800">Twilio UI</div></p><p>To do that of course you need a server on the internet that can run your code. This is where
<a href=https://firebase.google.com/ class=underline target=_blank rel=noopener>Firebase
</a>comes in handy — it&rsquo;s quick and free to get something like that going.</p><p>So I signed up for Twilio, and set up Firebase, where I wrote some code that would text me on my physical phone if I won with my digital Twilio phone number. I still had to manually submit two entries per day (one per phone number), and manually redeem the texted codes in Vault, but hey, I could do two entries per day! Just a matter of getting a couple more phone numbers now!</p><p><img class="mx-auto my-4" src=/img/boost-bars/policeman-blowing-whistle.jpg alt="Criminal detected"><div class="text-center my-2 font-sans text-md text-grey-800">Criminal detected</div></p><p>Twilio were one step ahead of me though. After your Twilio trial (<em>and after you pay them money</em>), if you try to register more than one phone number they lock your account until you prove you aren&rsquo;t using their services for anything nefarious. This makes sense as ~naughty little chocolate goblins~ spammers and scammers could abuse the platform.</p><p>I was presented with a form to fill in, asking about what kind of messages I&rsquo;d be sending, what my website is, and so on. I figured they were mostly concerned about <em>outgoing spam</em> based on the questions they were asking, so I gave it a crack and was fairly honest. I said I&rsquo;d not be sending anything outbound, I just wanted use the service to &ldquo;avoid providing my own personal phone number when filling in online forms&rdquo; (100% true and honest and brave).</p><p>To my surprise they accepted this, but that back-and-forth took a while. The free bar competition period was already half over, and I needed to make my money back on these phone numbers.</p><h2 id=automation>Automation</h2><p>Now that I had four phone numbers, the first step was automating entering into the competition. As I mentioned this involved filling in a form and submitting proof of purchase, which is a photo of the bar and the barcode number.</p><div class=well><h3 id=why-only-four-phone-numbers-and-not-40>Why only four phone numbers and not 40?</h3><ul><li>Firstly, I couldn&rsquo;t be 100% sure that this whole thing was going to work, so I didn&rsquo;t want to risk wasting $200. $20 was the minimum I could spend which let me buy 3 extra phone numbers for the month.</li><li>Secondly, I was more interested in getting everything hooked up and working for the sake of curiosity and learning, than actually making as much money as possible.</li></ul></div><p>At a glance you might think a photo and barcode is a sound proof of purchase. But what if I told you the barcode numbers are the same on every Boost bar? So you could in fact take a photo of any old Boost bar, enter the one common barcode number, and proof complete. Maybe you could even just keep posting the <em>same</em> photo of the <em>same</em> Boost bar and they wouldn&rsquo;t care?</p><p>…Okay, using the same photo twice, it got rejected. But it took some time. I reckon there&rsquo;s some simple verification perhaps to check you aren&rsquo;t using an <em>identical</em> image, that would be pretty easy to do. But multiple images of the same bar was getting through fine.</p><p>I then proceeded to take ~150 photos (four phone numbers × 30 days left, plus some extra just in case) from different angles and a few different backgrounds of some bars, uploaded them to Firebase, and wrote some code that each day would pull a photo from that queue and fill in the competition form using that photo as proof of purchase.</p><p><img class="mx-auto my-4" src=/img/boost-bars/boost-collage.jpg alt="So many bars!"><div class="text-center my-2 font-sans text-md text-grey-800">So many bars!</div></p><p>Next, instead of getting a text to my real phone if I won, I stored the winning codes (which, remember, then need to go into the Vault Payments app) in a database. So I now essentially had a big spreadsheet of winning codes that filled up bit by bit each day.</p><p><img class="mx-auto my-4" src=/img/boost-bars/wins.jpg alt="The wins were rolling in"><div class="text-center my-2 font-sans text-md text-grey-800">The wins were rolling in</div></p><h2 id=redeeming>Redeeming</h2><p>The final step of automating it all was getting the code redeemed in the Vault app. In order to figure out how it worked, I needed to be able to see what the Vault app is sending and receiving over the internet in order to get the Visa card numbers. For a website, this is really easy using the
<a href=https://developer.chrome.com/docs/devtools/network class=underline target=_blank rel=noopener>Network tab of Chrome developer tools
</a>, but you can&rsquo;t do that with an app.</p><h3 id=proxyman>Proxyman</h3><p>Using a tool called
<a href=https://proxyman.io/ class=underline target=_blank rel=noopener>Proxyman
</a>, along with
<a href=https://docs.proxyman.io/debug-devices/ios-device class=underline target=_blank rel=noopener>changing some settings on my phone
</a>, I could make my phone send and receive its traffic via my computer instead of directly to the internet. Proxyman then allows me to look at what the phone was sending and receiving just like the Network tab in developer tools.</p><p>This all happens in real time, so as I navigated around and used the app, I could see what data my phone was sending and receiving for each part of the app. All I had to do was redeem a code, observe the data, and then programmatically do the same thing but with different code.</p><h3 id=what-redeeming-a-code-looks-like>What redeeming a code looks like</h3><p><img class="mx-auto my-4" src=/img/boost-bars/pman0.jpg alt="Claiming a token was a very simple POST request"><div class="text-center my-2 font-sans text-md text-grey-800">Claiming a token was a very simple POST request</div></p><p>It looks like to redeem a code, the app just sends a POST request to <code>https://eml.azure-api.net/v2/claim</code> with a JSON body containing <code>activationCode</code> (which comes from the text message), and then the <code>phoneNumber</code> it was sent to. Fantastically simple!</p><div class=well><p><strong>They changed this quickly:</strong> After just <em>one</em> day of doing this, I noticed my code spitting out errors during the redemption process. The <code>claim</code> request had started to fail. I opened the Vault app with Proxyman listening to see what was going on, and was immediately met with an updated app UI. Not a good sign — things had definitely changed!</p><p>I tried to re-redeem the codes that errored earlier. They worked, but the data looked very different.</p><p><img class="mx-auto my-4" src=/img/boost-bars/pman1.jpg alt="Redeeming became a lot more complicated"><div class="text-center my-2 font-sans text-md text-grey-800">Redeeming became a lot more complicated</div></p><p>I was running out of time, and some brief Googling showed that they too were probably using Firebase and that
<a href="https://cloud.google.com/identity-platform/docs/reference/rest/v1/accounts/sendVerificationCode#:~:text=app%20token%20validation.-,At%20least%20one%20of%20%28iosReceipt%20and%20iosSecret%29%2C%20recaptchaToken%2C%20or%20safetyNetToken%20must%20be%20specified%20to%20verify%20the%20verification%20code%20is%20being%20sent%20on%20behalf%20of%20a%20real%20app%20and%20not%20an%20emulator,-.%20This%20should%20come" class="underline break-words" target=_blank rel=noopener>the new claim process involved a &ldquo;physical device check&rdquo;
</a>which made it much harder for me to do this programmatically. I decided to give up on redeeming, and just focused on collecting the codes for now.</p></div><h3 id=what-browsing-the-visa-card-numbers-looks-like>What browsing the Visa card numbers looks like</h3><p>In the Vault app, once the code is redeemed, it takes you to your account page where it shows you all your Visa cards. It doesn&rsquo;t just show you the card number and CVV and all that immediately, no; this whole write up could be two sections shorter if it did.</p><p>After redeeming a card, this is what the request looks like for viewing your account page:</p><p><img class="mx-auto my-4" src=/img/boost-bars/pmanCensoredCard.jpg alt="Notice the censored card details"><div class="text-center my-2 font-sans text-md text-grey-800">Notice the censored card details</div></p><p>From your account page you can &ldquo;inspect&rdquo; a card to view its details (number, CVV, all that good stuff). But the request and response for that looked like this in Proxyman:</p><p><img class="mx-auto my-4" src=/img/boost-bars/pmanDip.jpg alt="None of these look like Visa card numbers"><div class="text-center my-2 font-sans text-md text-grey-800">None of these look like Visa card numbers</div></p><p>Where are the card numbers? Why can I see them on the app, but they seemingly aren&rsquo;t there in Proxyman?</p><h2 id=eml-and-dip>EML and DIP</h2><p>I figured the information must be in there, just encrypted in some way. I happen to live with known hacker and custodian of
<a href=https://mango.pdf.zone/ class=underline target=_blank rel=noopener>the mango zone
</a>&ldquo;Alex&rdquo; which is possibly the most convenient and most expert help possible for this exact particular situation.</p><p>Anyway, &ldquo;eml&rdquo; (in the request subdomain) and &ldquo;dip&rdquo; (in the request response) popped into google yielded the
<a href=https://developer.emerchants.com.au/ class=underline target=_blank rel=noopener>EML Money In Motion™ payments API
</a>. On that page is some
<a href=https://developer.emerchants.com.au/dip/#decrypting-with-aes-256 class=underline target=_blank rel=noopener>incredibly useful writing
</a>on how DIP (Digital Interface Payload) works.</p><p><img class="mx-auto my-4" src=/img/diaDiagram.png alt="How to decode a DIP"><div class="text-center my-2 font-sans text-md text-grey-800">How to decode a DIP</div></p><p>The details of this diagram aren&rsquo;t super important, but basically it tells us that you can un-scromble a DIP if you have:</p><ul><li>The 68 character string (we have that, &ldquo;dip&rdquo; in the response from before was 68 characters)</li><li>The ephemeral key (we have that, <code>ephemeralKey</code> is sent as part of the request)</li><li>The application key</li></ul><p>That last one is interesting — we have a <code>keyId</code>, but not exactly the application key. According to the docs,
<a href=https://developer.emerchants.com.au/dip/#identifiers-and-keys class=underline target=_blank rel=noopener>keyId is just an identifier
</a>for a pre-shared, secret key. So the Vault payments app when they were setting up their EML Money In Motion™ payments API account must have said, &ldquo;hey, for keyId <code>851ebb5d-3318-4472-b5ee-a055a38711b2</code>, the secret is <em>&lt;secretKey></em>.</p><p>The problem is, I don&rsquo;t know what <code>secretKey</code> is, so I can&rsquo;t unscramble the DIP. This is by design: if I was only eavesdropping the internet requests, and had no other information, I&rsquo;d be cooked.</p><h3 id=but-i-have-other-information>But I have other information</h3><p>The thing is, I was looking at the Visa card number, CVV, etc. on my phone. That means the app can unscramble the DIP, so it must have the secret key in there somewhere buried deep down in the confines of its mind.</p><p>So now I need to poke around the confines of its mind AKA look inside the app. Googling &ldquo;download app file from app store&rdquo; points us to
<a href=https://github.com/majd/ipatool class=underline target=_blank rel=noopener>IPATool
</a>, which made it easy to download the app bundle. Luckily app bundles are just zips (
<a href=https://stackoverflow.com/questions/62929717/why-do-many-file-formats-are-disguised-zip-files class=underline target=_blank rel=noopener>as per usual
</a>), so from there I could unzip and poke around.</p><p>With all two of our braincells came up with the idea of essentially &ldquo;ctrl + f -> &lsquo;secret&rsquo;&rdquo; which instantly revealed the <code>secretKey</code> we were looking for:</p><p><img class="mx-auto my-4" src=/img/boost-bars/grepSecret.jpg alt="This is how you &amp;ldquo;ctrl + f -&amp;gt; &amp;lsquo;secret&amp;rsquo;&amp;rdquo; recursively in files"><div class="text-center my-2 font-sans text-md text-grey-800">This is how you &ldquo;ctrl + f -> &lsquo;secret&rsquo;&rdquo; recursively in files</div></p><p>That pointed us to the <code>Info.plist</code> file which just had it sitting there:</p><p><img class="mx-auto my-4" src=/img/boost-bars/appSecretInPlist.jpg alt="Ladies and gentlemen, we got him"><div class="text-center my-2 font-sans text-md text-grey-800">Ladies and gentlemen, we got him</div></p><p><strong>Note: they have since fixed this too.</strong></p><p>After writing some code that took all those pieces and followed the instructions from the DIP diagram earlier to unscramble to DIP, we tested out the key we found and it worked!</p><h2 id=what-we-have-at-this-point>What we have at this point</h2><ul><li>A submission bot that is entering four entries per day pulling from the queue of 150 photos</li><li>A growing database of winning codes</li><li>No way to submit the codes 😥</li><li>A way to decrypt Visa card numbers in the Vault account</li></ul><h2 id=wait-so-when-do-we-get-infinite-chocolate>Wait so when do we get infinite chocolate</h2><p>In the end, to great disappointment, I first manually redeemed all the winning codes in the Vault app. Their updated security worked! It just wasn&rsquo;t worth the effort to figure out or work around their new redemption process. Thankfully it only took about 20 seconds per code. I was thankful that I didn&rsquo;t end up buying 40 phone numbers!</p><p>After I redeemed them all, with Proxyman active I was able to &ldquo;inspect&rdquo; all of the Visa cards, getting their DIPs. They were then decrypted programmatically and stored in a spreadsheet.</p><p><img class="mx-auto my-4" src=/img/boost-bars/money.jpg alt="A unrelated image displaying way more money than I made"><div class="text-center my-2 font-sans text-md text-grey-800">A unrelated image displaying way more money than I made</div></p><p>And that&rsquo;s where I&rsquo;ve left the project today. The next step would be trying to consolidate the ~80 $3 prepaid Visa cards into one account using a card processor like Stripe.</p><p>I wish that I had a video of me making a snow angel in Boost bars to wrap this up for you. But alas, all either of us are left with is the story of a guy who over-engineered the joy of a sweet treat.</p></div><hr class="mb-6 mt-24"><div class="flex flex-wrap justify-between items-center"><div class="mb-1 text-center sm:text-left overflow-ellipsis pr-1"><a class="mr-4 no-underline" href=https://blakerspace.net/blog/private-server-history/><img src=/%20/icons/top_arrow.svg class="transform -rotate-90 inline-block">
</a><a href=https://blakerspace.net/blog/private-server-history/><span class=underline>I learnt to code on World of Warcraft private servers</span></a></div></div><hr class=my-6><div class="flex justify-center items-center flex-wrap"><a href=mailto:yaboy@blakerspace.net title=email class="bg-black rounded-full p-3 mx-2 my-2 transform hover:scale-110 active:scale-90 transition-transform duration-300 ease-in-out"><img src=/icons/email.svg alt="email icon" class="w-4 h-4 md:w-6 md:h-6 blend-diff"></a></div><div class=mt-6></div></main><div class="absolute bottom-0 w-full"><footer class="w-full h-24 text-center text-xs text-gray-400 bg-black relative"><div class="w-full px-6 md:pt-0 md:mx-auto md:max-w-5xl flex flex-1 space-between items-center absolute-center"><a href=https://blakerspace.net/ class=absolute><div class="w-8 h-8 relative font-bold bg-white blend-diff"><h1 class="absolute-center m-0 font-charter text-2xl text-gray-100 blend-diff select-none">B</h1></div></a><div class="h-full flex-1"><span class=select-none><a href=https://github.com/negrel/hugo-theme-pico class="text-gray-400 hover:text-gray-200 no-underline">Pico</a>
theme for
<a href=https://gohugo.io/ class="text-gray-400 hover:text-gray-200 no-underline">Hugo</a></span></div></div></footer></div></body></html>